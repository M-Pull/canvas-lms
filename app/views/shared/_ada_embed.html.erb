<%-
# Copyright (C) 2025 - present Instructure, Inc.
#
# This file is part of Canvas.
#
# Canvas is free software: you can redistribute it and/or modify it under
# the terms of the GNU Affero General Public License as published by the Free
# Software Foundation, version 3 of the License.
#
# Canvas is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
# A PARTICULAR PURPOSE. See the GNU Affero General Public License for more
# details.
#
# You should have received a copy of the GNU Affero General Public License along
# with this program. If not, see <http://www.gnu.org/licenses/>.
-%>

<script type="text/javascript">
  (function() {
    if (!ENV) { return }

    const user = ENV.current_user || {}
    const roles = ENV.current_user_roles || []

    window.adaSettings = {
      crossWindowPersistence: true,
      metaFields: {
        institutionUrl: window.location.origin,
        email: user.email || '',
        name: user.display_name || '',
        canvasRoles: roles.join(','),
        canvasUUID: ENV.DOMAIN_ROOT_ACCOUNT_UUID || '',
        isRootAdmin: roles.includes('root_admin'),
        isAdmin: roles.includes('admin'),
        isTeacher: roles.includes('teacher'),
        isStudent: roles.includes('student'),
        isObserver: roles.includes('observer')
      }
    };
  })()
</script>
<script async id="__ada" data-lazy data-handle="instructure-gen" src="https://static.ada.support/embed2.js"></script>

query GetModuleItemsQuery($moduleId: ID!, $cursor: String, $first: Int) {
  legacyNode(_id: $moduleId, type: Module) {
    ... on Module {
      moduleItemsConnection(first: $first, after: $cursor) {
        edges {
          cursor
          node {
            _id
            id
            url
            title
            indent
            newTab
            position
            masterCourseRestrictions {
              content
              points
              availabilityDates
              settings
              dueDates
              all
            }
            content {
              ... on Assignment {
                _id
                id
                title
                type: __typename
                pointsPossible
                graded
                dueAt(applyOverrides: false)
                lockAt(applyOverrides: false)
                unlockAt(applyOverrides: false)
                isNewQuiz
                published
                canUnpublish
                isLockedByMasterCourse
                canDuplicate
                assignmentOverrides(first: 100) {
                  edges {
                    cursor
                    node {
                      _id
                      dueAt
                      lockAt
                      unlockAt
                      set {
                        ... on AdhocStudents {
                          students {
                            id
                          }
                        }
                        ... on Course {
                          courseId: id
                        }
                        ... on Group {
                          groupId: id
                        }
                        ... on Section {
                          sectionId: id
                        }
                      }
                    }
                  }
                }
                assignedToDates {
                  id
                  dueAt
                  unlockAt
                  lockAt
                  title
                  base
                  set {
                    id
                    type
                  }
                }
                submissionsConnection(filter: { includeUnsubmitted: true }) {
                  nodes {
                    _id
                    cachedDueDate
                    missing
                  }
                }
              }
              ... on Discussion {
                _id
                id
                title
                type: __typename
                lockAt
                todoDate
                discussionType
                published
                canUnpublish
                isLockedByMasterCourse
                canDuplicate
                graded
                replyToEntryRequiredCount
                submissionsConnection(filter: { includeUnsubmitted: true }) {
                  nodes {
                    _id
                    cachedDueDate
                    missing
                  }
                }
                checkpoints {
                  dueAt(applyOverrides: true)
                  name
                  tag
                }
                assignment {
                  _id
                  dueAt(applyOverrides: false)
                  assignmentOverrides(first: 100) {
                    edges {
                      cursor
                      node {
                        _id
                        dueAt
                        lockAt
                        unlockAt
                        set {
                          ... on AdhocStudents {
                            students {
                              id
                            }
                          }
                          ... on Course {
                            courseId: id
                          }
                          ... on Group {
                            groupId: id
                          }
                          ... on Section {
                            sectionId: id
                          }
                        }
                      }
                    }
                  }
                }
                assignedToDates {
                  id
                  dueAt
                  unlockAt
                  lockAt
                  title
                  base
                  set {
                    id
                    type
                  }
                }
              }
              ... on File {
                _id
                id
                title: displayName
                type: __typename
                contentType
                size
                thumbnailUrl
                url
                published
                canUnpublish
                isLockedByMasterCourse
                canDuplicate
                fileState
                locked
                lockAt
                unlockAt
                graded
              }
              ... on Page {
                _id
                id
                title
                published
                canUnpublish
                type: __typename
                isLockedByMasterCourse
                canDuplicate
                graded
              }
              ... on Quiz {
                _id
                id
                title
                type: __typename
                pointsPossible
                published
                canUnpublish
                isLockedByMasterCourse
                canDuplicate
                graded
                assignedToDates {
                  id
                  dueAt
                  unlockAt
                  lockAt
                  title
                  base
                  set {
                    id
                    type
                  }
                }
                submissionsConnection(filter: { includeUnsubmitted: true }) {
                  nodes {
                    _id
                    cachedDueDate
                    missing
                  }
                }
              }
              ... on ExternalUrl {
                title
                type: __typename
                url
                published
                canUnpublish
                newTab
                graded
              }
              ... on ModuleExternalTool {
                title
                type: __typename
                url
                published
                canUnpublish
                graded
              }
              ... on ExternalTool {
                type: __typename
                url
                published
                canUnpublish
                graded
              }
              ... on SubHeader {
                title
                published
                type: __typename
              }
            }
          }
        }
        pageInfo {
          hasNextPage
          endCursor
        }
      }
    }
  }
}
